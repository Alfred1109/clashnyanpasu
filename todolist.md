# 项目冗余优化 TODO 清单

## 🎯 高优先级 - 立即可执行

### 前端依赖优化

#### Hook 库合并

- [ ] **统一 Hook 库使用**
  - 当前状态: `ahooks` + `react-use` + `@uidotdev/usehooks` 三个库共存
  - 目标: 统一使用 `ahooks`（功能最全，维护最好）
  - 影响: 预计减少 ~50KB 打包体积，编译时间减少 10-15%
  - 步骤:
    - [ ] 审查 `react-use` 的使用情况，迁移到 `ahooks` 对应 hook
    - [ ] 审查 `@uidotdev/usehooks` 的使用情况，迁移到 `ahooks`
    - [ ] 移除 `react-use` 和 `@uidotdev/usehooks` 依赖
    - [ ] 测试所有相关功能

#### 查询库选择

- [ ] **统一数据获取方案**
  - 当前状态: `@tanstack/react-query` + `swr` 共存
  - 目标: 选择一个主要方案
  - 影响: 预计减少 ~30KB，编译时间减少 ~5%
  - 选项:
    - [ ] 方案A: 全面迁移到 `@tanstack/react-query`（推荐，功能更强）
    - [ ] 方案B: 统一使用 `swr`（更轻量）
  - 步骤:
    - [ ] 分析当前两个库的使用场景分布
    - [ ] 制定迁移计划
    - [ ] 执行迁移
    - [ ] 移除废弃的库

#### 颜色处理库合并

- [ ] **统一颜色选择器**
  - 当前状态: `@uiw/react-color` + `mui-color-input` 功能重叠
  - 目标: 根据实际需求选择保留一个
  - 步骤:
    - [ ] 调研两个库的使用场景
    - [ ] 选择保留的库
    - [ ] 迁移相关代码
    - [ ] 移除多余的依赖

### Rust 依赖优化

#### 哈希库精简

- [ ] **减少哈希算法依赖**
  - 当前状态: `md-5` + `sha2` + `seahash` + `rustc-hash`
  - 目标: 保留 `sha2`（安全哈希）+ `rustc-hash`（快速哈希）
  - 影响: 编译时间减少 8-12%
  - 步骤:
    - [ ] 审查 `md-5` 的使用场景，评估是否可以用 `sha2` 替代
    - [ ] 审查 `seahash` 的使用场景，评估是否可以用 `rustc-hash` 替代
    - [ ] 替换相关代码
    - [ ] 移除不需要的依赖
    - [ ] 运行测试确保功能正常

#### OXC 依赖整理

- [ ] **检查 OXC 解析器依赖**
  - 当前状态: 6个独立的 `oxc_*` 包
  - 目标: 确认是否都必需，或使用统一包
  - 依赖列表:
    - `oxc_parser`
    - `oxc_allocator`
    - `oxc_span`
    - `oxc_ast`
    - `oxc_syntax`
    - `oxc_ast_visit`
  - 步骤:
    - [ ] 分析每个 oxc 包的实际使用情况
    - [ ] 研究是否可以使用统一的 `oxc` 包
    - [ ] 如果可以，执行依赖替换
    - [ ] 测试 JavaScript/脚本解析功能

## 🔧 中优先级 - 需要评估

### UI 组件库评估

- [ ] **MUI + Radix UI 混用分析**
  - 当前状态: 同时使用 `@mui/material` 和多个 `@radix-ui/*` 包
  - 目标: 评估是否可以统一为一套组件系统
  - 步骤:
    - [ ] 统计 MUI 组件的使用情况
    - [ ] 统计 Radix UI 组件的使用情况
    - [ ] 分析两套组件系统的重叠功能
    - [ ] 制定统一方案（如果可行）

### 图像处理优化

- [ ] **图像处理库评估**
  - 当前状态: `image` + `fast_image_resize`
  - 目标: 确认是否都必需
  - 步骤:
    - [ ] 分析 `image` 库的使用场景
    - [ ] 分析 `fast_image_resize` 的使用场景
    - [ ] 评估是否可以合并或精简

### 压缩算法优化

- [ ] **压缩库整理**
  - 当前状态: `flate2` + `zip` + `zip-extensions` + `adler`
  - 目标: 根据实际需求优化
  - 步骤:
    - [ ] 分析各压缩库的使用场景
    - [ ] 评估是否可以减少依赖数量
    - [ ] 优化 features 配置

## 🏗️ 低优先级 - 长期优化

### 异步工具整理

- [ ] **异步库依赖优化**
  - 当前状态: `tokio-util` + `futures` + `futures-util` + `oneshot`
  - 目标: 减少重叠功能的依赖
  - 步骤:
    - [ ] 分析各异步工具的使用情况
    - [ ] 识别功能重叠的部分
    - [ ] 制定整合方案

### 构建配置优化

- [ ] **检查构建流程冗余**
  - [ ] 分析 `pnpm` 脚本是否有重复工作
  - [ ] 检查 Tauri 构建配置的优化空间
  - [ ] 评估 `vite` 构建配置的优化可能

### 代码重复分析

- [ ] **组件代码重复检查**
  - [ ] 使用工具扫描相似的组件代码
  - [ ] 识别可以提取的通用逻辑
  - [ ] 创建共用工具函数或组件

## 📊 预期效果总结

### 编译性能提升

- 前端 Hook 库合并: ~10-15% 编译时间减少
- 查询库统一: ~5% 编译时间减少
- Rust 哈希库精简: ~8-12% 编译时间减少
- **总计预期**: ~20-30% 编译时间减少

### 打包体积优化

- Hook 库合并: ~50KB 减少
- 查询库统一: ~30KB 减少
- UI 组件优化: 待评估
- **总计预期**: ~80KB+ 减少

### 维护性提升

- 减少依赖冲突的可能性
- 简化升级和维护工作
- 提高代码一致性

## ⚠️ 注意事项

1. **渐进式优化**: 建议分批次执行，避免一次性大规模修改
2. **充分测试**: 每次优化后都需要完整的功能测试
3. **性能监控**: 优化前后对比编译时间和运行时性能
4. **回滚准备**: 每个优化步骤都应该有回滚方案
5. **团队协调**: 如果是团队项目，需要与其他开发者协调

---

_创建日期: 2026-01-11_  
_最后更新: 2026-01-11_
